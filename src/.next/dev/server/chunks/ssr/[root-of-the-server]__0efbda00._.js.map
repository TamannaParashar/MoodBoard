{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Tamz%20Laptop/MoodBoard/src/app/chat/page.jsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useEffect, useState, useRef } from \"react\"\r\nimport io from \"socket.io-client\"\r\n\r\nlet socket\r\n\r\nexport default function ChatPage({ searchParams }) {\r\n  const { roomId, from, to } = searchParams\r\n  const [messages, setMessages] = useState([])\r\n  const [text, setText] = useState(\"\")\r\n  const bottomRef = useRef(null)\r\n\r\n  useEffect(() => {\r\n    socket = io()\r\n\r\n    socket.emit(\"join-room\", roomId)\r\n\r\n    socket.on(\"receive-message\", (msg) => {\r\n      setMessages((prev) => [...prev, msg])\r\n    })\r\n\r\n    fetch(`/api/userChat/history?roomId=${roomId}`)\r\n      .then((res) => res.json())\r\n      .then((data) => setMessages(data.messages || []))\r\n\r\n    return () => socket.disconnect()\r\n  }, [roomId])\r\n\r\n  useEffect(() => {\r\n    bottomRef.current?.scrollIntoView({ behavior: \"smooth\" })\r\n  }, [messages])\r\n\r\n  const sendMessage = () => {\r\n    if (!text.trim()) return\r\n\r\n    socket.emit(\"send-message\", {\r\n      roomId,\r\n      senderId: from,\r\n      receiverId: to,\r\n      message: text,\r\n    })\r\n\r\n    setText(\"\")\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-slate-900 text-white flex flex-col\">\r\n      <div className=\"flex-1 overflow-y-auto p-6 space-y-4\">\r\n        {messages.map((m) => (\r\n          <div\r\n            key={m._id}\r\n            className={`max-w-xs p-3 rounded-lg ${\r\n              m.senderId === from ? \"bg-indigo-600 ml-auto\" : \"bg-slate-700\"\r\n            }`}\r\n          >\r\n            {m.message}\r\n          </div>\r\n        ))}\r\n        <div ref={bottomRef} />\r\n      </div>\r\n\r\n      <div className=\"p-4 flex gap-3 border-t border-slate-700\">\r\n        <input\r\n          value={text}\r\n          onChange={(e) => setText(e.target.value)}\r\n          className=\"flex-1 p-3 rounded bg-slate-800\"\r\n          placeholder=\"Type a message...\"\r\n        />\r\n        <button\r\n          onClick={sendMessage}\r\n          className=\"px-6 bg-indigo-600 rounded\"\r\n        >\r\n          Send\r\n        </button>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAKA,IAAI;AAEW,SAAS,SAAS,EAAE,YAAY,EAAE;IAC/C,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,EAAE,GAAG;IAC7B,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC,EAAE;IAC3C,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAC;IACjC,MAAM,YAAY,IAAA,+MAAM,EAAC;IAEzB,IAAA,kNAAS,EAAC;QACR,SAAS,IAAA,mMAAE;QAEX,OAAO,IAAI,CAAC,aAAa;QAEzB,OAAO,EAAE,CAAC,mBAAmB,CAAC;YAC5B,YAAY,CAAC,OAAS;uBAAI;oBAAM;iBAAI;QACtC;QAEA,MAAM,CAAC,6BAA6B,EAAE,QAAQ,EAC3C,IAAI,CAAC,CAAC,MAAQ,IAAI,IAAI,IACtB,IAAI,CAAC,CAAC,OAAS,YAAY,KAAK,QAAQ,IAAI,EAAE;QAEjD,OAAO,IAAM,OAAO,UAAU;IAChC,GAAG;QAAC;KAAO;IAEX,IAAA,kNAAS,EAAC;QACR,UAAU,OAAO,EAAE,eAAe;YAAE,UAAU;QAAS;IACzD,GAAG;QAAC;KAAS;IAEb,MAAM,cAAc;QAClB,IAAI,CAAC,KAAK,IAAI,IAAI;QAElB,OAAO,IAAI,CAAC,gBAAgB;YAC1B;YACA,UAAU;YACV,YAAY;YACZ,SAAS;QACX;QAEA,QAAQ;IACV;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;oBACZ,SAAS,GAAG,CAAC,CAAC,kBACb,8OAAC;4BAEC,WAAW,CAAC,wBAAwB,EAClC,EAAE,QAAQ,KAAK,OAAO,0BAA0B,gBAChD;sCAED,EAAE,OAAO;2BALL,EAAE,GAAG;;;;;kCAQd,8OAAC;wBAAI,KAAK;;;;;;;;;;;;0BAGZ,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBACC,OAAO;wBACP,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;wBACvC,WAAU;wBACV,aAAY;;;;;;kCAEd,8OAAC;wBACC,SAAS;wBACT,WAAU;kCACX;;;;;;;;;;;;;;;;;;AAMT"}}]
}