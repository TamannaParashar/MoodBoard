{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Tamz%20Laptop/MoodBoard/src/app/chat/page.jsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useEffect, useState, useRef } from \"react\"\r\nimport { useSearchParams } from \"next/navigation\"\r\nimport io from \"socket.io-client\"\r\n\r\nlet socket\r\n\r\nexport default function ChatPage() {\r\n  const searchParams = useSearchParams()\r\n  const roomId = searchParams.get(\"roomId\")\r\n  const from = searchParams.get(\"from\")\r\n  const to = searchParams.get(\"to\")\r\n\r\n  const [messages, setMessages] = useState([])\r\n  const [text, setText] = useState(\"\")\r\n  const bottomRef = useRef(null)\r\n\r\n  useEffect(() => {\r\n    if (!roomId) return\r\n\r\n    socket = io()\r\n\r\n    socket.emit(\"join-room\", roomId)\r\n\r\n    socket.on(\"receive-message\", (msg) => {\r\n      setMessages((prev) => [...prev, msg])\r\n    })\r\n\r\n    // Fetch chat history\r\n    fetch(`/api/userChat/history?roomId=${roomId}`)\r\n      .then((res) => res.json())\r\n      .then((data) => setMessages(data.messages || []))\r\n\r\n    return () => socket.disconnect()\r\n  }, [roomId])\r\n\r\n  useEffect(() => {\r\n    bottomRef.current?.scrollIntoView({ behavior: \"smooth\" })\r\n  }, [messages])\r\n\r\n  const sendMessage = () => {\r\n    if (!text.trim() || !from || !to) return\r\n\r\n    socket.emit(\"send-message\", {\r\n      roomId,\r\n      senderId: from,\r\n      receiverId: to,\r\n      message: text,\r\n    })\r\n\r\n    setText(\"\")\r\n  }\r\n\r\n  if (!roomId || !from || !to) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center text-green\">\r\n        Missing chat parameters\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-slate-900 text-white flex flex-col\">\r\n      <div className=\"flex-1 overflow-y-auto p-6 space-y-4\">\r\n        {messages.map((m) => (\r\n          <div\r\n            key={m._id}\r\n            className={`max-w-xs p-3 rounded-lg ${\r\n              m.senderId === from ? \"bg-indigo-600 ml-auto\" : \"bg-slate-700\"\r\n            }`}\r\n          >\r\n            {m.message}\r\n          </div>\r\n        ))}\r\n        <div ref={bottomRef} />\r\n      </div>\r\n\r\n      <div className=\"p-4 flex gap-3 border-t border-slate-700\">\r\n        <input\r\n          value={text}\r\n          onChange={(e) => setText(e.target.value)}\r\n          className=\"flex-1 p-3 rounded bg-slate-800\"\r\n          placeholder=\"Type a message...\"\r\n        />\r\n        <button\r\n          onClick={sendMessage}\r\n          className=\"px-6 bg-indigo-600 rounded\"\r\n        >\r\n          Send\r\n        </button>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAMA,IAAI;AAEW,SAAS;IACtB,MAAM,eAAe,IAAA,qJAAe;IACpC,MAAM,SAAS,aAAa,GAAG,CAAC;IAChC,MAAM,OAAO,aAAa,GAAG,CAAC;IAC9B,MAAM,KAAK,aAAa,GAAG,CAAC;IAE5B,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC,EAAE;IAC3C,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAC;IACjC,MAAM,YAAY,IAAA,+MAAM,EAAC;IAEzB,IAAA,kNAAS,EAAC;QACR,IAAI,CAAC,QAAQ;QAEb,SAAS,IAAA,mMAAE;QAEX,OAAO,IAAI,CAAC,aAAa;QAEzB,OAAO,EAAE,CAAC,mBAAmB,CAAC;YAC5B,YAAY,CAAC,OAAS;uBAAI;oBAAM;iBAAI;QACtC;QAEA,qBAAqB;QACrB,MAAM,CAAC,6BAA6B,EAAE,QAAQ,EAC3C,IAAI,CAAC,CAAC,MAAQ,IAAI,IAAI,IACtB,IAAI,CAAC,CAAC,OAAS,YAAY,KAAK,QAAQ,IAAI,EAAE;QAEjD,OAAO,IAAM,OAAO,UAAU;IAChC,GAAG;QAAC;KAAO;IAEX,IAAA,kNAAS,EAAC;QACR,UAAU,OAAO,EAAE,eAAe;YAAE,UAAU;QAAS;IACzD,GAAG;QAAC;KAAS;IAEb,MAAM,cAAc;QAClB,IAAI,CAAC,KAAK,IAAI,MAAM,CAAC,QAAQ,CAAC,IAAI;QAElC,OAAO,IAAI,CAAC,gBAAgB;YAC1B;YACA,UAAU;YACV,YAAY;YACZ,SAAS;QACX;QAEA,QAAQ;IACV;IAEA,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI;QAC3B,qBACE,8OAAC;YAAI,WAAU;sBAA2D;;;;;;IAI9E;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;oBACZ,SAAS,GAAG,CAAC,CAAC,kBACb,8OAAC;4BAEC,WAAW,CAAC,wBAAwB,EAClC,EAAE,QAAQ,KAAK,OAAO,0BAA0B,gBAChD;sCAED,EAAE,OAAO;2BALL,EAAE,GAAG;;;;;kCAQd,8OAAC;wBAAI,KAAK;;;;;;;;;;;;0BAGZ,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBACC,OAAO;wBACP,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;wBACvC,WAAU;wBACV,aAAY;;;;;;kCAEd,8OAAC;wBACC,SAAS;wBACT,WAAU;kCACX;;;;;;;;;;;;;;;;;;AAMT"}}]
}